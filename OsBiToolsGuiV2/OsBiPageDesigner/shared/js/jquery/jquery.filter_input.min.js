!function(l){l.fn.extend({filter_input:function(i){i=l.extend({regex:".",live:!1,events:"keypress paste"},i);var a=l.isFunction(i.onChange),n=l.isFunction(i.onText),o=l.isFunction(i.onEmpty);function f(e){var t=!1;return"number"==typeof e.selectionStart&&(t=0==e.selectionStart&&e.selectionEnd==e.value.length),t}function s(e){var t=!1;return"number"==typeof e.selectionStart&&(t=e.selectionStart!=e.selectionEnd),t}function r(e){var t=e.input?e.input:this,n=t.value;if("keydown"==e.type){var r=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(8==r||46==r){if(o){if(f(t))return void i.onEmpty(l(t));if(1==n.length&&"number"==typeof t.selectionStart&&(8==r&&1==t.selectionStart||46==r&&0==t.selectionStart))return void i.onEmpty(l(t))}a&&(s(t)?i.onChange(l(t)):0<n.length&&"number"==typeof t.selectionStart&&(8==r&&0<t.selectionStart||46==r&&t.selectionEnd<t.value.length)&&i.onChange(l(t)))}}else if("cut"==e.type){if(o&&f(t))return void i.onEmpty(l(t));s(t)&&a&&i.onChange(l(t))}}function u(e){var t=e.input?e.input:l(this);if(!e.ctrlKey&&!e.altKey){if("keypress"==e.type){var n=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(13==n)return l.isFunction(i.onEnter)&&i.onEnter(),!1;var r=String.fromCharCode(n),o=(t.val(),new RegExp(i.regex))}else{if("paste"==e.type)return t.data("value_before_paste",e.target.value),setTimeout(function(){u({type:"after_paste",input:t})},1),!0;if("after_paste"!=e.type)return!1;r=t.val(),t.val(),o=new RegExp("^("+i.regex+")+$")}return o.test(r)?(a&&i.onChange(t),!0):("function"==typeof i.feedback&&i.feedback.call(this,r),"after_paste"==e.type&&t.val(t.data("value_before_paste")),!1)}}var e=l.fn.jquery.split(".");if(!i.live)return this.each(function(){var e=l(this);if(o||a||n){var t="cut keydown";e.off(t).on(t,r)}if(n){t="keyup";e.off(t).on(t,function(){i.onText(e.val())})}e.off(i.events).on(i.events,u)});1<=parseInt(e[0])&&7<=parseInt(e[1])?l(this).on(i.events,u):l(this).live(i.events,u)}})}(jQuery);